@using GigTracker.Entities;
@using Microsoft.AspNetCore.Http
@using GigTracker.Views.Home
@model HomeIndexViewModel
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@{
    Layout = "_Layout";

}

<!DOCTYPE html>

<html>
<body>
    <input asp-for="userId" />
    <input asp-for="userRole" />

    <nav class="navbar navbar-expand-md navbar-custom">
        <div class="navbar-collapse collapse w-100 order-1 order-md-0 dual-collapse2">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a asp-controller="Account" asp-action="Login" class="btn btn-default menu-button">Login</a>
                </li>
                @if (Model.userRole == "Admin" || Model.userRole == "User") {
                    <li class="nav-item">
                        <a asp-controller="Gig" asp-action="List" class="btn btn-default menu-button">Gigs</a>
                    </li>
                    <li class="nav-item">
                        <a asp-controller="User" asp-action="Profile" asp-route-id=@Model.userId class="btn btn-default menu-button">Profile</a>
                    </li>
                }
                @if (Model.userRole == "Admin") {
                    <li class="nav-item">
                        <a asp-controller="User" asp-action="List" class="btn btn-default menu-button">Users</a>
                    </li>
                }
            </ul>
        </div>
        <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <input asp-for="ArtistSearch" name="searchArtist" id="searchArtist" class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                </li>
            </ul>
        </div>
    </nav>

    Button to Open the Modal
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
        Open modal
    </button>

    <!-- The Modal -->
    <div class="modal" id="myModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">Modal Heading</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
                <div id="modalErrorTxt" name="modalErrorTxt" class="modal-body">
                    @Model.ErrorMsg
                </div>

                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>

    <partial name="_GigList" for="Gigs" />

</body>
</html>

<script>
    $(document).ready(function () {
        $("#btnShowModal").click(function () {
            $("#loginModal").modal('show');
        });

        $("#btnHideModal").click(function () {
            $("#loginModal").modal('hide');
        });

        var i = '@Model.ErrorMsg';
        if (i != "")
        {
            //var myDiv = document.getElementById("modalErrorTxt");
            //myDiv.innerHtml = i;

            $('#myModal').modal('show');

        };
    });

    $('#searchArtist').on('keypress', function (e) {
        if (e.which === 13) {

            //Disable textbox to prevent multiple submit
            $(this).attr("disabled", "disabled");

            //Do Stuff, submit, etc..
            var artistquery = $(this).val();

            $.get("", { artistQuery: artistquery, page: 1 }, function (result) {
                $("body").html(result);
            });

            //Enable the textbox again if needed.
            $(this).removeAttr("disabled");
        }
    });

</script>
